
# AWS Infrastructure Automation with Terraform, Ansible & Jenkins

This project provisions an AWS environment using **Terraform**, configures servers with **Ansible**, and automates the entire workflow using a **Jenkins CI/CD pipeline**.

![ansible1](https://github.com/user-attachments/assets/5b62e2c8-06ab-451f-b496-140ccbd77776)
![ansible3](https://github.com/user-attachments/assets/e504e97f-3b6c-4a89-8461-9130ebdb386c)
![ansible2](https://github.com/user-attachments/assets/a8b524df-e34e-46ce-8137-d738e6cbfc90)

---

## ğŸ“Œ Project Overview

This repository demonstrates a full **DevOps workflow**:

* **Terraform** â€“ AWS infrastructure provisioning (VPC, subnets, security groups, EC2)
* **Ansible** â€“ Server configuration (packages, Nginx, Docker, web content)
* **Jenkins** â€“ CI/CD automation using Pipeline as Code (`Jenkinsfile`)

The goal is to show how infrastructure provisioning and configuration management can be fully automated from a single Git push.

---

## ğŸ— Architecture

**Cloud Provider:** AWS
**Provisioning:** Terraform
**Configuration Management:** Ansible
**CI/CD:** Jenkins (Pipeline as Code)

### High-Level Flow

1. Developer pushes code to GitHub
2. GitHub webhook triggers Jenkins
3. Jenkins runs Terraform:

   * `init` â†’ `plan` â†’ **manual approval** â†’ `apply`
4. Terraform creates AWS infrastructure and generates an Ansible inventory
5. Jenkins runs Ansible to configure EC2 instances and deploy the web application

---

## ğŸ“ Repository Structure

```text
project/
â”œâ”€â”€ terraform/
â”‚   â”œâ”€â”€ main.tf
â”‚   â”œâ”€â”€ variables.tf
â”‚   â”œâ”€â”€ outputs.tf
â”‚   â”œâ”€â”€ inventory.tf
â”‚   â”œâ”€â”€ inventory.tftpl
â”‚   â””â”€â”€ terraform.tfvars
â”œâ”€â”€ ansible/
â”‚   â”œâ”€â”€ ansible.cfg
â”‚   â”œâ”€â”€ inventory.ini        # Generated by Terraform
â”‚   â”œâ”€â”€ playbooks/
â”‚   â”‚   â””â”€â”€ site.yml
â”‚   â””â”€â”€ roles/
â”‚       â”œâ”€â”€ common/
â”‚       â”‚   â””â”€â”€ tasks/main.yml
â”‚       â”œâ”€â”€ nginx/
â”‚       â”‚   â”œâ”€â”€ tasks/main.yml
â”‚       â”‚   â””â”€â”€ handlers/main.yml
â”‚       â””â”€â”€ docker/
â”‚           â””â”€â”€ tasks/main.yml
â””â”€â”€ Jenkinsfile
```

---

## ğŸŒ Terraform Details

### Responsibilities

* Create VPC, Internet Gateway, route table, and public subnet
* Create security groups for web servers and Jenkins
* Launch EC2 instances (web servers and optional Jenkins server)
* Reference an existing SSH key pair
* Generate Ansible inventory (`ansible/inventory.ini`) using `local_file` and `inventory.tftpl`

### Key Commands

```bash
cd terraform
terraform init
terraform validate
terraform plan
terraform apply
terraform destroy
```

Variables are defined in `variables.tf`, with values provided via `terraform.tfvars` (region, instance type, instance count, key name, SSH key paths, etc.).

---

## âš™ï¸ Ansible Details

### Responsibilities

* Install common system packages (curl, git, vim, etc.)
* Install and configure **Nginx**
* Install and start **Docker**
* Deploy a static HTML page to `/var/www/html/index.html`

### Main Entrypoint

```bash
cd ansible
ansible web -m ping -i inventory.ini
ansible-playbook -i inventory.ini playbooks/site.yml
```

The inventory file is automatically generated by Terraform and includes public IPs of the EC2 web servers and the SSH key path.

---

## ğŸš€ Jenkins CI/CD Pipeline

The `Jenkinsfile` defines a multi-stage pipeline:

1. **Checkout** â€“ Pull latest code from GitHub
2. **Terraform Init & Validate**
3. **Terraform Plan** â€“ Generate execution plan
4. **Manual Approval** â€“ Safety gate before applying changes
5. **Terraform Apply** â€“ Provision infrastructure
6. **Wait for EC2** â€“ Allow instances to finish booting
7. **Debug Inventory** â€“ Optional diagnostics
8. **Configure with Ansible** â€“ Run playbooks on provisioned hosts

### Jenkins Server Setup

Typical prerequisites:

* Java & Jenkins installed
* Terraform and Ansible installed
* SSH key for Jenkins user (`/var/lib/jenkins/.ssh/id_rsa`)
* AWS credentials configured in Jenkins
* Pipeline job configured with:

  * SCM: Git
  * Script Path: `Jenkinsfile`

---

## ğŸ”— GitHub Webhook (Optional)

To enable automatic CI/CD on every push:

1. Enable **GitHub hook trigger for GITScm polling** in Jenkins
2. Add a webhook in GitHub repository settings:

* **Payload URL:** `http://<JENKINS_IP>:8080/github-webhook/`
* **Event:** Push events

---

## ğŸ§ª Run Locally (Without Jenkins)

### Prerequisites

* Terraform
* Ansible
* AWS credentials configured locally
* SSH key generated and referenced in `terraform.tfvars`

### Steps

```bash
cd terraform
terraform init
terraform apply

cd ../ansible
ansible-playbook -i inventory.ini playbooks/site.yml
```

Open the web server public IPs in a browser (available via Terraform output `web_server_ips`).

---

## ğŸ“ Notes & Next Steps

This project is **learning-oriented** and demonstrates a real-world DevOps stack using Terraform, Ansible, and Jenkins on AWS.

Possible improvements:

* Remote Terraform backend (S3 + DynamoDB)
* Environment separation (dev / stage / prod)
* Monitoring and health checks
* HTTPS and domain integration (ALB + ACM)
* Application deployment pipelines

Feel free to extend the playbooks, Terraform modules, and Jenkins stages to fit more advanced use cases ğŸš€
